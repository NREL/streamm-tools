<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>particles &mdash; STREAMM-Tools 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="STREAMM-Tools 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
  
<a href="../index.html"><img src="../_static/logo.png" border="0" alt="sampledoc"/></a>
</div>



  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          STREAMM-Tools</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Installation / Getting starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework_design.html">STREAMM code description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Applications</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <h1>Source code for particles</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Class data structures for atomic data</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">sys</span>
    
<div class="viewcode-block" id="Particle"><a class="viewcode-back" href="../docstr_particles.html#particles.Particle">[docs]</a><span class="k">class</span> <span class="nc">Particle</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Data structure for describing any localized object in QM/MD simulations</span>
<span class="sd">    A &#39;Particle&#39; has a position and type specifiers</span>

<span class="sd">    Note, for an object p1 of Particle type</span>
<span class="sd">      p1.__dict__ returns a dictionary of all class members</span>

<span class="sd">    Current use cases include: atoms, united-atoms and &#39;beads&#39;</span>

<span class="sd">    Possible tags: ELN = [], ASYMB = [], CTYPE = [],  CHARGES = [],  R = [], VEL = []</span>
<span class="sd">                   ATYPE = [], AMASS = [], MOLNUMB = [], RING_NUMB = [], RESID = [],</span>
<span class="sd">                   RESN = [], CHARN = [], UNITNUMB = [], UNITTYPE = []</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;blank&quot;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for a general particle. Checks for types in arguments</span>
<span class="sd">        and throws a TypeError when appropriate. User must set units consistently.</span>

<span class="sd">        Args:</span>
<span class="sd">            pos     (list)  Cartesian position vector (arb. units)</span>
<span class="sd">            type     (str)  String identifier (eg, Si, UA1, Bead1)</span>
<span class="sd">            charge (float)  Charge value in arb. units</span>
<span class="sd">            mass   (float)  Mass in arb. units</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;1st arg should be list of floats&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;2nd arg should be string type&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">charge</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;3rd arg should be float value&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">mass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;4th arg should be float value&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>

	<span class="c"># Tags dictionary. To be set by caller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	TWK: Remove for release</span>
<span class="sd">	# Tags dictionary. To be set by caller</span>
<span class="sd">        self.tagsDict[&quot;chain&quot;] = 1</span>
<span class="sd">        self.tagsDict[&quot;ring&quot;] = 0</span>
<span class="sd">        self.tagsDict[&quot;resname&quot;] = &quot;RES&quot; </span>
<span class="sd">        self.tagsDict[&quot;residue&quot;] = 1 </span>
<span class="sd">        self.tagsDict[&quot;qgroup&quot;] = 0</span>
<span class="sd">        self.tagsDict[&quot;linkid&quot;] = &quot;??&quot;</span>
<span class="sd">        self.tagsDict[&quot;cplytag&quot;] = &quot;&quot;</span>
<span class="sd">        self.tagsDict[&quot;gtype&quot;] = type</span>
<span class="sd">        self.tagsDict[&quot;lmptype&quot;] = 0</span>
<span class="sd">        self.tagsDict[&quot;fftype&quot;] = &quot;??&quot;</span>
<span class="sd">        self.tagsDict[&quot;symbol&quot;] = &quot;??&quot;</span>
<span class="sd">        self.tagsDict[&quot;number&quot;] = 0</span>
<span class="sd">        self.tagsDict[&quot;mass&quot;] = self.mass  </span>
<span class="sd">        self.tagsDict[&quot;ffmass&quot;] = self.mass  </span>
<span class="sd">        self.tagsDict[&quot;cov_radii&quot;] = 0.0</span>
<span class="sd">        self.tagsDict[&quot;vdw_radii&quot;] = 0.0</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Destructor, clears object memory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span>


<div class="viewcode-block" id="Particle.setTagsDict"><a class="viewcode-back" href="../docstr_particles.html#particles.Particle.setTagsDict">[docs]</a>    <span class="k">def</span> <span class="nf">setTagsDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define custom dictionary for id tags (eg {&quot;molnum&quot;:1,})</span>
<span class="sd">        Leaving type tag as a default</span>

<span class="sd">        Args:</span>
<span class="sd">            td (dictionary)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newdict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">newdict</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Particle.isTagEqualTo"><a class="viewcode-back" href="../docstr_particles.html#particles.Particle.isTagEqualTo">[docs]</a>    <span class="k">def</span> <span class="nf">isTagEqualTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">valList</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if tags[key]= any of the values in valList. Exits if key not in dictionary</span>

<span class="sd">        Args:</span>
<span class="sd">            key            dictionary key</span>
<span class="sd">            valList (list) dictionary values</span>
<span class="sd">            </span>
<span class="sd">        Returns: true if tagsDict[key]=value for any value in valueList</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valueList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="c"># If valueList not a list... convert to one for logic below</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">valList</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">valueList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valList</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valueList</span> <span class="o">=</span> <span class="n">valList</span>

        <span class="n">tagKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tagKeys</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Tag key in Particle dictionary does not exist&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> 

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">valueList</span><span class="p">:</span>                 <span class="c"># Look at each search value</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagsDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">==</span><span class="n">value</span><span class="p">):</span>     <span class="c"># Determine if key,value match</span>
                <span class="k">return</span> <span class="bp">True</span>
     
        <span class="c"># If loop above has not returned with a found (True) state then</span>
        <span class="c"># return with False (meaning not ANY value in valueList was present</span>
        <span class="k">return</span> <span class="bp">False</span>


</div>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method for printng contents of container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> </span><span class="si">%f</span><span class="s"> </span><span class="si">%f</span><span class="s"> </span><span class="si">%f</span><span class="s"> </span><span class="si">%f</span><span class="s"> </span><span class="si">%f</span><span class="s">  &quot;</span><span class="o">%</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="ParticleContainer"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer">[docs]</a><span class="k">class</span> <span class="nc">ParticleContainer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main data structure for holding Particle objects. Map of global</span>
<span class="sd">    particle ID (integer) to Particle object instances</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idList</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor: sets up a dictionary for indexing &#39;Particle&#39; objects</span>

<span class="sd">        Args:</span>
<span class="sd">            idList (list): of particle IDs. If empty then ID starts at 1.</span>
<span class="sd">                If not empty then ID&#39;s (keys) are inititalized with empty particle objects</span>
<span class="sd">            verbose (bool): flag for printing status/debug info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>                              <span class="c"># Creates empty dict struc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">Particle</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">idList</span><span class="p">}</span> <span class="c"># Creates empty Particle objs</span>
                                                           <span class="c">#  if idList not empty</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>         <span class="c"># If list not set in constructor arg</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span><span class="o">=</span><span class="mi">0</span>            <span class="c"># default=0 if idList empty</span>
        <span class="k">else</span><span class="p">:</span>                        <span class="c">#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">idList</span><span class="p">)</span>  <span class="c"># take max in list for maxgid</span>


    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Destructor, clears dictionary memory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Cleaning particle container&quot;</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span>


<div class="viewcode-block" id="ParticleContainer.dump"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filePrefix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dump a pickled version of this object</span>

<span class="sd">        Args:</span>
<span class="sd">            filePrefix (str): name of pickle file. will dump filePrefix.pkl</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pickle</span> 
        <span class="n">fileObj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePrefix</span> <span class="o">+</span> <span class="s">&#39;.pkl&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileObj</span><span class="p">)</span>
        <span class="n">fileObj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method for returning size of container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method for printng contents of container</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ptclStr</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"> Contains particle objects: </span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">for</span> <span class="n">gid</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">:</span>
            <span class="n">ptclStr</span>  <span class="o">+=</span>  <span class="s">&quot; </span><span class="si">%d</span><span class="s"> : </span><span class="si">%s</span><span class="s">  </span><span class="se">\n</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span>  <span class="n">gid</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">gid</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ptclStr</span>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">ptcl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method implementing obj[]=value operator</span>
<span class="sd">        Performs deep copy of value so container is managing memory</span>
<span class="sd">        If gid exists in container then particle object is overwritten.</span>
<span class="sd">        If gid does not exist then particle object is inserted in container</span>
<span class="sd">        using the &#39;put()&#39; method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ptcl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Using [] operator for non-existent key&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method implementing obj[] operator.</span>
<span class="sd">        Operations on returned elements change container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method implementing del obj[] operator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method implementing (for x in &#39;this&#39;)....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># return iter(self.particles)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idSubList</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callable magic method. Returns iterator to subset particle dictionary</span>

<span class="sd">        Args:</span>
<span class="sd">             idSubList (list) list of pid-s of particle objects to be returned</span>
<span class="sd">             </span>
<span class="sd">        Returns: iterator to subset of particle dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">subGroupDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">idSubList</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">ptclObj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">idSubList</span><span class="p">:</span>
                    <span class="n">subGroupDct</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">ptclObj</span>
            <span class="k">return</span> <span class="n">subGroupDct</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Callable ParticleContainer requires a list of subgroup particle IDs&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method implementing in keyword (key in obj&#39;)....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span>


    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &#39;Magic&#39; method to implement the &#39;+=&#39; operator</span>
<span class="sd">        </span>
<span class="sd">        Compare global IDs of particles and reassign globalIDs for particle</span>
<span class="sd">        container using the max ID between the two lists.</span>

<span class="sd">        Note: for now this reassigns ID always. Furthermore, any bond containers with</span>
<span class="sd">              particleID already set will NOT be changed. See structureContainer iadd</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">keys1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>     <span class="c"># global IDs in this object</span>
        <span class="n">keys2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>    <span class="c"># global IDs in object being added</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">keys1</span> <span class="o">+</span> <span class="n">keys2</span><span class="p">)</span>  <span class="c"># find max globalID in keys, set this object maxID</span>

        <span class="k">for</span> <span class="n">ptclkey2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">particles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">ptclkey2</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="bp">self</span>


<div class="viewcode-block" id="ParticleContainer.put"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.put">[docs]</a>    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptcl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append &#39;Particle&#39; object to this container. Updates globalID for container</span>
<span class="sd">        by incrementing the maxgid member. Performs deep copy of ptcl so container</span>
<span class="sd">        is managing memory</span>

<span class="sd">        Args:</span>
<span class="sd">            ptcl (Particle) correctly initialized Particle object</span>

<span class="sd">        NOTE:</span>
<span class="sd">            (1) One can imagine extra conditions on distances between ptcl being</span>
<span class="sd">                inserted and current particles.</span>
<span class="sd">            (2) This could check for uniqueness of all globalID&#39;s and throw error</span>
<span class="sd">                for copies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ptcl</span><span class="p">,</span> <span class="n">Particle</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ptcl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Attempting to add non-Particle type to container&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>

</div>
<div class="viewcode-block" id="ParticleContainer.replaceID"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.replaceID">[docs]</a>    <span class="k">def</span> <span class="nf">replaceID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">findID</span><span class="p">,</span> <span class="n">newID</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace global particle ID with another value. Attempts to make rational</span>
<span class="sd">        checks about new IDs</span>

<span class="sd">        Args:</span>
<span class="sd">            findGID (int) ptcl ID to search</span>
<span class="sd">            newGID  (int) ptcl ID to replace findGID with</span>

<span class="sd">        Returns:</span>
<span class="sd">            Errors if</span>
<span class="sd">              - findGID not found</span>
<span class="sd">              - newGID already present</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">findID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;replaceID: findID not found&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">newID</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;replaceID: newID already exists&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">newID</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span><span class="p">:</span>
            <span class="c"># Pop off value for old key and reset with new key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">newID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">findID</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">newID</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="c"># If newID happens to be next ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="p">[</span><span class="n">newID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">findID</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxgid</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Error: ParticleContainer:replaceID newID &gt;= maxgid </span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ParticleContainer.getParticlesWithTags"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.getParticlesWithTags">[docs]</a>    <span class="k">def</span> <span class="nf">getParticlesWithTags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchDict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return particles whose dictionary tags match all specified key,values</span>
<span class="sd">        The search dictionary criteria is that ALL key,value pairs must match</span>
<span class="sd">        (the logic is {key1:value1} AND {key2:value2}.....</span>

<span class="sd">        Args:</span>
<span class="sd">            searchDict (dict) dictionary of search pairs {keyTag:valTag}....</span>
<span class="sd">            </span>
<span class="sd">        Returns: list of particle gid&#39;s that satisfy search</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">subGroupGID</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">tagFoundBoolList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;search = &quot;</span><span class="p">,</span> <span class="n">searchDict</span>
            
        <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">ptclObj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>            <span class="c"># Iterate on particles</span>
            <span class="k">for</span> <span class="n">searchTag</span><span class="p">,</span> <span class="n">searchVal</span> <span class="ow">in</span> <span class="n">searchDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>    <span class="c"># Iterate on dict items to search</span>
                
                <span class="n">tagEqual</span> <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">isTagEqualTo</span><span class="p">(</span><span class="n">searchTag</span><span class="p">,</span> <span class="n">searchVal</span><span class="p">)</span>  <span class="c"># Check if dct[searchTag]=searchVal</span>
                <span class="n">tagFoundBoolList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tagEqual</span><span class="p">)</span>                      <span class="c"># Store list of all results</span>

            <span class="k">if</span> <span class="bp">False</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tagFoundBoolList</span><span class="p">:</span>    <span class="c"># If only True-s in list then all conditions met (AND condition)</span>
                <span class="n">subGroupGID</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>          <span class="c"># so store pid of particle</span>
            <span class="n">tagFoundBoolList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>            <span class="c"># Reset tag found list</span>

        <span class="k">return</span> <span class="n">subGroupGID</span>

        
</div>
<div class="viewcode-block" id="ParticleContainer.getTypeInfoDict"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.getTypeInfoDict">[docs]</a>    <span class="k">def</span> <span class="nf">getTypeInfoDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a map of type to (typeIndex, mass, charge)</span>
<span class="sd">        Method assigns a type index and checkes for consistency</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionary of {type:[typeIndex, mass, charge], ....}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Look for types and get unique list</span>
        <span class="n">typeList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">ptclObj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">ptclType</span> <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">type</span>
            <span class="n">typeList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptclType</span><span class="p">)</span>
        <span class="n">typeList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">typeList</span><span class="p">))</span>
        
        <span class="c"># Generate list of unique type for keys to initialize dictionary</span>
        <span class="n">typeMassDict</span>  <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">typeList</span><span class="p">}</span>                    <span class="c"># dict for mass</span>
        <span class="n">typeChargeDict</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">typeList</span><span class="p">}</span>                    <span class="c"># dict for charge</span>
        <span class="n">typeIndexDict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">typeList</span><span class="p">)}</span> <span class="c"># dict for typeIndex</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Unique types = &quot;</span><span class="p">,</span> <span class="n">typeList</span>
            <span class="k">print</span> <span class="s">&quot;typeIndexDict = &quot;</span><span class="p">,</span> <span class="n">typeIndexDict</span>

        <span class="c"># Search for dataName and track with type</span>
        <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">ptclObj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>

            <span class="n">ptclType</span>   <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">type</span>           <span class="c"># ptclType is key for dictionary</span>
            <span class="n">ptclMass</span>   <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">mass</span>
            <span class="n">ptclCharge</span> <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">charge</span>

            <span class="n">dataList</span> <span class="o">=</span> <span class="n">typeMassDict</span><span class="p">[</span><span class="n">ptclType</span><span class="p">]</span>   <span class="c"># Update pre-existing data list</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptclMass</span><span class="p">)</span>           <span class="c"># Append to running list</span>
            <span class="n">typeMassDict</span><span class="p">[</span><span class="n">ptclType</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataList</span>   <span class="c"># Keep map of {ptclID: dataList}</span>

            <span class="n">dataList</span> <span class="o">=</span> <span class="n">typeChargeDict</span><span class="p">[</span><span class="n">ptclType</span><span class="p">]</span>  <span class="c"># Update pre-existing data list</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptclCharge</span><span class="p">)</span>          <span class="c"># Append to running list</span>
            <span class="n">typeChargeDict</span><span class="p">[</span><span class="n">ptclType</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataList</span>  <span class="c"># Keep map of {ptclID: dataList}</span>


        <span class="c"># Check for consistency mass</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">typeMassDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">valSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>                  <span class="c"># Generate unique set of values</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valSet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>                <span class="c"># and check for length=1 (consistency)</span>
               <span class="k">print</span> <span class="s">&quot;More than one mass found for &quot;</span><span class="p">,</span> <span class="n">key</span>
               <span class="k">print</span> <span class="s">&quot;Check Particle() object initialization&quot;</span>
               <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">typeMassDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>         <span class="c"># If unique value make correct dict val</span>

        <span class="c"># Check for consistency charge</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">typeChargeDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">valSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>                  <span class="c"># Generate unique set of values</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valSet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>                <span class="c"># and check for length=1 (consistency)</span>
               <span class="k">print</span> <span class="s">&quot;More than one charge found for &quot;</span><span class="p">,</span> <span class="n">key</span>
               <span class="k">print</span> <span class="s">&quot;Check Particle() object initialization&quot;</span>
               <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">typeChargeDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="c"># If unique value make correct dict val</span>

        <span class="c"># Pack mass,charge,typeIndex to new dictionary</span>
        <span class="n">typeInfoDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">typeIndexDict</span><span class="p">:</span>
            <span class="n">index</span>  <span class="o">=</span> <span class="n">typeIndexDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">mass</span>   <span class="o">=</span> <span class="n">typeMassDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="n">typeChargeDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">typeInfoDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">charge</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">typeInfoDict</span>

</div>
<div class="viewcode-block" id="ParticleContainer.scatterPlot"><a class="viewcode-back" href="../docstr_particles.html#particles.ParticleContainer.scatterPlot">[docs]</a>    <span class="k">def</span> <span class="nf">scatterPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a scatter plot of particle positions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Error: matplotlib.pyplot module not found, check PYTHONPATH or install from source&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Error: mpl_toolkits.mplot3d module not found, check PYTHONPATH or install from source&quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="c"># Unpack position data and put into list</span>
        <span class="n">posDat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">ptclObj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ptclObj</span><span class="o">.</span><span class="n">position</span>
            <span class="n">posDat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="c"># Analyze results</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">posDat</span><span class="p">]</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">posDat</span><span class="p">]</span>
        <span class="n">col3</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">posDat</span><span class="p">]</span>

        <span class="c"># Make 3d scatter</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;x [A]&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;y [A]&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">&quot;z [A]&quot;</span><span class="p">)</span>
        
        <span class="c"># Name plot and output to file</span>
        <span class="n">distName</span> <span class="o">=</span> <span class="s">&quot;particleContainer.png&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Plotting &quot;</span><span class="p">,</span> <span class="n">distName</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">distName</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>
</pre></div>

    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Dr. Scott W. Sides, Dr. Travis Kemper, Dr. Ross Larsen, Dr. Peter Graf.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>